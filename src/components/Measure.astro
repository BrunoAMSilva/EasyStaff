---
import type { HTMLAttributes } from "astro/types";
import Note from "./Note.astro";

interface Props extends HTMLAttributes<"div"> {
    measure: Measure;
    measureIndex: number;
    clef: "treble" | "bass";
}

const {
    measure,
    measureIndex,
    clef,
    class: className = "",
    ...rest
} = Astro.props as Props;

/* console.log(measure.beats[2].tokens, 'measure beats'); */
---

{
    measure.beats.map((beat, index) => {
        if (!beat) return null;
        return beat.tokens.map((note, noteIndex) => {
            if (note.type !== "note") return null;

            return (
                <Note
                    note={note}
                    beat={(index + 1) + ((measureIndex) * 4)}
                    clef={clef}
                />
            );
        });
    })
}
